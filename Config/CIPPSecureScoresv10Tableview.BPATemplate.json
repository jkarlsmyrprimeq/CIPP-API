{
  "name": "CIPP SecureScores v1.0 - Table view",
  "style": "Table",
  "Fields": [
    {
      "name": "SecureDefaultState",
      "UseExistingInfo": false,
      "FrontendFields": [
        {
          "name": "Secure Defaults State Enabled",
          "value": "SecureDefaultState",
          "formatter": "warnBool"
        }
      ],
      "StoreAs": "bool",
      "API": "Graph",
      "ExtractFields": [
        "IsEnabled"
      ],
      "parameters": {
        "asApp": false
      },
      "URL": "https://graph.microsoft.com/beta/policies/identitySecurityDefaultsEnforcementPolicy"
    },
    {
      "name": "CurrentSecureScore",
      "UseExistingInfo": false,
      "FrontendFields": [
        {
          "name": "Current Secure Score",
          "value": "CurrentSecureScore.currentScore"
        },
        {
          "name": "Max Secure Score",
          "value": "CurrentSecureScore.maxScore"
        },
        {
          "name": "Average Comparative Score (All Tenants)",
          "value": "CurrentSecureScore.averageComparativeScores[0].averageScore"
        },
        {
          "name": "Average Comparative Score (Similiar Size Tenants)",
          "value": "CurrentSecureScore.averageComparativeScores[1].averageScore"
        }
      ],
      "StoreAs": "JSON",
      "API": "Graph",
      "ExtractFields": [
        "currentScore",
        "maxScore",
        "averageComparativeScores"
      ],
      "URL": "https://graph.microsoft.com/beta/security/secureScores?$top=1"
    }
  ]
}
